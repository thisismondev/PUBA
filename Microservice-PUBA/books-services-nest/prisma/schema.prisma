// Prisma Schema untuk Books Service
// Dokumentasi: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
}

// Model untuk tabel books
model Book {
    id               BigInt   @id @default(autoincrement()) @db.BigInt
    isbn             String?  @unique
    title            String
    author           String
    publisher        String?
    category         String?
    publication_year Int?
    cover_url        String?
    created_at       DateTime @default(now()) @db.Timestamptz(6)
    updated_at       DateTime @updatedAt @db.Timestamptz(6)

    // Relasi one-to-many dengan BookItem
    items BookItem[]

    @@map("books")
}

// Model untuk tabel book_items
model BookItem {
    id             BigInt     @id @default(autoincrement()) @db.BigInt
    book_id        BigInt     @db.BigInt
    inventory_code String     @unique
    status         ItemStatus @default(available)
    rack_location  String?
    created_at     DateTime   @default(now()) @db.Timestamptz(6)

    // Relasi many-to-one dengan Book
    book Book @relation(fields: [book_id], references: [id], onDelete: Cascade)

    @@index([book_id])
    @@map("book_items")
}

// Enum untuk status item buku
enum ItemStatus {
    available
    borrowed
    lost
    repair
}
